{% extends "labeller/base.html" %}
{% load static %}

{% block title %}Label Region{% endblock %}

{% block content %}
<script src="{% static 'labeller/Cell.js' %}"></script>
<script src="{% static 'labeller/CellCounter.js' %}"></script>
<script>
//	all_cells = Cell.LoadCellsFromJson(cells_json);
//	cell_counter = new CellCounter(all_cells);

</script>


<div id='labeller'>

	{% include "labeller/partials/region_annotator.html" %}

	<div id="column2_wrapper">

		{% include "labeller/partials/mini_counter.html" %}

		{% include "labeller/partials/dot_legend.html" %}

		{% include "labeller/partials/current_cell.html" %}

	</div>


</div>
{% include "labeller/partials/big_table.html" %}

<div id="test_keyboard">Last Key Pressed: </div>
<p id="additional_instructions">Press left and right arrows to change cell</p>
<p id="additional_instructions">Click on cell to select it, or to create a new cell</p>

{% include "labeller/partials/main_lineages_horizontal.html" %}

{% include "labeller/partials/help_display.html" %}


{% endblock content %}

{% block scripts %} 



<script type="text/javascript">
	function addMouseEventListeners(region_id){
		console.log("adding mouse event listeners");
		// $('.cell_list_item').on('click', function() {
		// 	console.log("this item was clicked on", $(this))
		// 	Cell.updateCurrentCell($(this))
		// });

		$('.dot').on('click', function() {
			console.log("this dot was clicked on", $(this))
			Cell.updateCurrentCellFromDot($(this), region_id)
		});
		// $('.regionCanvas').on('click', function(e) {
		// 	console.log("canvas was clicked", $(this))
		// 	createNewCell(this, e)
		// });
		// $('#helpscreen').click(function() { 
	 //        $(this).fadeOut(500);
	 //    });
	}

	var cells_json = [];
	var all_cells = {};
	var current_cell_cid = '-1';
	var region_rid = '{{region.rid}}';

	if ('{{cells_json}}'!='none') {		
	 	cells_json = '{{cells_json}}';
	 	CellCounter.updateCountsOnPageJson(cells_json);
	 	all_cells = Cell.LoadCellsFromJson(cells_json);
	 	Cell.updateCurrentCell($('#currentCell_'+Cell.currentCellCID()+'.current_cell'), all_cells);
	}

	Cell.addKeyboardEventListeners();
	addMouseEventListeners(region_rid);


	// var region_img_url = '{{region.image.url}}';
	// console.log('region image path = ', region_img_url)


//	console.log("all cells:", all_cells);
	//Cell.populateCellLists(all_cells);


	// addKeyboardEventListeners(cell_counter);
	// addMouseEventListeners(cell_counter);


//	var static_image_path = "{% static 'labeller/images/' %}";
//	console.log("static", static_image_path);
</script>

<script src="{% static 'labeller/label_region.js' %}"></script>

{% endblock scripts %}